<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>BabylonJS Bike Loader</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <!-- BabylonJS CDN -->
  <script src="https://cdn.babylonjs.com/babylon.js"></script>
  <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
  <style>
    html, body {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #0b0f14;
      font-family: system-ui, sans-serif;
      -webkit-user-select: none;
      -webkit-touch-callout: none;
    }
    #renderCanvas {
      width: 100%;
      height: 100%;
      touch-action: none; /* Prevent page scroll while rotating */
      display: block;
    }
    #ui {
      position: absolute;
      top: 10px; left: 10px; right: 10px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      z-index: 10;
      background: rgba(0,0,0,0.5);
      padding: 8px;
      border-radius: 12px;
      align-items: center;
    }
    #ui input, #ui button {
      flex: 1;
      min-width: 100px;
      font-size: 14px;
      padding: 8px 10px;
      border-radius: 8px;
      border: none;
      background: #1b1f26;
      color: #fff;
    }
    #status {
      flex-basis: 100%;
      font-size: 12px;
      text-align: center;
      color: #ccc;
    }
  </style>
</head>
<body>
  <div id="ui">
    <input id="fileInput" type="file" accept=".glb,.gltf" />
    <input id="urlInput" type="text" placeholder="https://example.com/bike.glb" />
    <button id="loadUrlBtn">Load</button>
    <span id="status">Ready</span>
  </div>
  <canvas id="renderCanvas"></canvas>

  <script>
    const canvas = document.getElementById("renderCanvas");
    const engine = new BABYLON.Engine(canvas, true);

    const createScene = () => {
      const scene = new BABYLON.Scene(engine);

      const camera = new BABYLON.ArcRotateCamera("cam",
        BABYLON.Tools.ToRadians(135),
        BABYLON.Tools.ToRadians(65),
        6,
        new BABYLON.Vector3(0, 1, 0),
        scene
      );
      camera.attachControl(canvas, true);
      camera.wheelDeltaPercentage = 0.01; // smoother zoom on mobile pinch

      const light = new BABYLON.HemisphericLight("light", new BABYLON.Vector3(0, 1, 0), scene);

      const ground = BABYLON.MeshBuilder.CreateGround("ground", { width: 40, height: 40 }, scene);
      ground.position.y = 0;

      const bikeParent = new BABYLON.TransformNode("bikeParent", scene);
bikeParent.scaling = new BABYLON.Vector3(1.5, 1.5, 1.5); 
      const status = msg => document.getElementById("status").textContent = msg;

      async function loadFromFile(file) {
        status("Loading file...");
        const container = await BABYLON.SceneLoader.LoadAssetContainerAsync("file:", file, scene, null, ".glb");
        container.addAllToScene();
        container.meshes.forEach(m => { if (!m.parent) m.parent = bikeParent; });
        status("Loaded: " + file.name);
      }

      async function loadFromUrl(url) {
        status("Loading URL...");
        const urlObj = new URL(url);
        const fileName = urlObj.pathname.split("/").pop();
        const folder = url.substring(0, url.lastIndexOf("/") + 1);
        const container = await BABYLON.SceneLoader.LoadAssetContainerAsync(folder, fileName, scene);
        container.addAllToScene();
        container.meshes.forEach(m => { if (!m.parent) m.parent = bikeParent; });
        status("Loaded: " + fileName);
      }

      document.getElementById("fileInput").addEventListener("change", e => {
        const file = e.target.files[0];
        if (file) loadFromFile(file).catch(err => status("Error loading file"));
      });

      document.getElementById("loadUrlBtn").addEventListener("click", () => {
        const url = document.getElementById("urlInput").value.trim();
        if (url) loadFromUrl(url).catch(err => status("Error loading URL"));
      });

      return scene;
    };

    const scene = createScene();
    engine.runRenderLoop(() => scene.render());
    window.addEventListener("resize", () => engine.resize());
  </script>
</body>
</html>